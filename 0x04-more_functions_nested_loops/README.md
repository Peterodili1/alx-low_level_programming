More functions, more nested loops to be debugged
